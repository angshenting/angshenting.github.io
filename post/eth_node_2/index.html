<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>ETH Node Part 2: 64 Bit Ubuntu | Shen Ting Ang</title><meta name=keywords content="ethereum,web3,node"><meta name=description content="Out of memory
So I left the node running for a few days and noticed the sync rate dropping significantly. Upon watching the log print for a while, I saw the following:

Aug 13 01:51:22 geth geth[12749]: runtime: out of memory: cannot allocate 4194304-byte block (2422145024 in use)
Aug 13 01:51:22 geth geth[12749]: fatal error: out of memory
Aug 13 01:51:22 geth geth[12749]: goroutine 16172 [running]:
Aug 13 01:51:22 geth geth[12749]: runtime.throw(0xce93c8, 0xd)"><meta name=author content="Shen Ting"><link rel=canonical href=https://shenting.org/post/eth_node_2/><link crossorigin=anonymous href=/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css integrity="sha256-j+ECM6cGvIfy4Is8+XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as=style><link rel=icon href=https://shenting.org/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://shenting.org/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://shenting.org/favicon-32x32.png><link rel=apple-touch-icon href=https://shenting.org/apple-touch-icon.png><link rel=mask-icon href=https://shenting.org/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://shenting.org/post/eth_node_2/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://shenting.org/post/eth_node_2/"><meta property="og:site_name" content="Shen Ting Ang"><meta property="og:title" content="ETH Node Part 2: 64 Bit Ubuntu"><meta property="og:description" content="Out of memory So I left the node running for a few days and noticed the sync rate dropping significantly. Upon watching the log print for a while, I saw the following:
Aug 13 01:51:22 geth geth[12749]: runtime: out of memory: cannot allocate 4194304-byte block (2422145024 in use)
Aug 13 01:51:22 geth geth[12749]: fatal error: out of memory
Aug 13 01:51:22 geth geth[12749]: goroutine 16172 [running]:
Aug 13 01:51:22 geth geth[12749]: runtime.throw(0xce93c8, 0xd)"><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2021-08-19T00:00:00+00:00"><meta property="article:modified_time" content="2021-08-19T00:00:00+00:00"><meta property="article:tag" content="Ethereum"><meta property="article:tag" content="Web3"><meta property="article:tag" content="Node"><meta name=twitter:card content="summary"><meta name=twitter:title content="ETH Node Part 2: 64 Bit Ubuntu"><meta name=twitter:description content="Out of memory
So I left the node running for a few days and noticed the sync rate dropping significantly. Upon watching the log print for a while, I saw the following:

Aug 13 01:51:22 geth geth[12749]: runtime: out of memory: cannot allocate 4194304-byte block (2422145024 in use)
Aug 13 01:51:22 geth geth[12749]: fatal error: out of memory
Aug 13 01:51:22 geth geth[12749]: goroutine 16172 [running]:
Aug 13 01:51:22 geth geth[12749]: runtime.throw(0xce93c8, 0xd)"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://shenting.org/post/"},{"@type":"ListItem","position":2,"name":"ETH Node Part 2: 64 Bit Ubuntu","item":"https://shenting.org/post/eth_node_2/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"ETH Node Part 2: 64 Bit Ubuntu","name":"ETH Node Part 2: 64 Bit Ubuntu","description":"Out of memory So I left the node running for a few days and noticed the sync rate dropping significantly. Upon watching the log print for a while, I saw the following:\nAug 13 01:51:22 geth geth[12749]: runtime: out of memory: cannot allocate 4194304-byte block (2422145024 in use)\nAug 13 01:51:22 geth geth[12749]: fatal error: out of memory\nAug 13 01:51:22 geth geth[12749]: goroutine 16172 [running]:\nAug 13 01:51:22 geth geth[12749]: runtime.throw(0xce93c8, 0xd)\n","keywords":["ethereum","web3","node"],"articleBody":"Out of memory So I left the node running for a few days and noticed the sync rate dropping significantly. Upon watching the log print for a while, I saw the following:\nAug 13 01:51:22 geth geth[12749]: runtime: out of memory: cannot allocate 4194304-byte block (2422145024 in use)\nAug 13 01:51:22 geth geth[12749]: fatal error: out of memory\nAug 13 01:51:22 geth geth[12749]: goroutine 16172 [running]:\nAug 13 01:51:22 geth geth[12749]: runtime.throw(0xce93c8, 0xd)\nAug 13 01:51:22 geth geth[12749]: #011runtime/panic.go:1117 +0x5c fp=0xc5b5334 sp=0xc5b5320 pc=0x5c328\nAug 13 01:51:22 geth geth[12749]: runtime.(*mcache).allocLarge(0xb6c53790, 0x8026, 0x20101, 0x29e20)\nAug 13 01:51:22 geth geth[12749]: #011runtime/mcache.go:226 +0x268 fp=0xc5b5364 sp=0xc5b5334 pc=0x3a888\nAug 13 01:51:22 geth geth[12749]: runtime.mallocgc(0x8026, 0xbaee50, 0x2001, 0x2bcf04)\nAug 13 01:51:22 geth geth[12749]: #011runtime/malloc.go:1078 +0x9c8 fp=0xc5b53c0 sp=0xc5b5364 pc=0x307d8\nAug 13 01:51:22 geth geth[12749]: runtime.makeslice(0xbaee50, 0x6922, 0x8026, 0x29ddc)\nAug 13 01:51:22 geth geth[12749]: #011runtime/slice.go:98 +0x6c fp=0xc5b53d4 sp=0xc5b53c0 pc=0x75a48\nWell, that’s not good. After this repeated a few times, I googled and realised that the default Raspbian OS wouldn’t work in terms of memory addressing. The solution would be to download the image off: https://ethereum.org/en/developers/tutorials/run-node-raspberry-pi/\nWrong Image For some reason I downloaded the image for NanoPC instead of Raspberry Pi, which wrote the SD card as ext4 instead of FAT. The site took really long to download the image (averaging 200KB/s for a 700MB file took an hour zzz), but once that was done, it took 10 minutes for the initial set up.\nNow to think of it, I downloaded the wrong image because the ethraspbian side wasn’t even allowing me to download the right image the other day, and going to ethraspbian.com directed me to the wrong image instead.\nSSH The first thing I noticed was slow response to the prompt after entering the password for SSH.\nThe top result on Google suggested DNS: https://jrs-s.net/2017/07/01/slow-ssh-logins/ but this wasn’t it. The helpful reminder was to use the -vv flag to debug, which led me to this: https://serverfault.com/questions/792486/ssh-connection-takes-forever-to-initiate-stuck-at-pledge-network. Checking the ssh config file revealed that it was PAM which was causing the issue. A restart of SSH daemon and the issue disappeared.\nRunning geth as a service [Note: because I used the ETH 2.0 image, and geth isn’t installed, I had to install golang and the latest version (1.10.7 as of writing) of geth manually, following the instructions from the previous guide.]\nThis failed repeatedly, despite the command running perfectly fine. Journalctl turns up nothing, but wait, a few other services are failing too, referencing to ‘/dev/sda1’. But we have no /dev/sda1, so I commented out the line in /etc/fstab, and rebooted with bated breath…no issues on reboot! And now systemctl starts geth immediately. Who would have thought it?\nAfter a few hours of troubleshooting, I have a sync-ing node again, and now I can monitor system parameters via Grafana. Let’s see how this goes!\n","wordCount":"465","inLanguage":"en","datePublished":"2021-08-19T00:00:00Z","dateModified":"2021-08-19T00:00:00Z","author":{"@type":"Person","name":"Shen Ting"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://shenting.org/post/eth_node_2/"},"publisher":{"@type":"Organization","name":"Shen Ting Ang","logo":{"@type":"ImageObject","url":"https://shenting.org/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://shenting.org/ accesskey=h title="Shen Ting Ang (Alt + H)">Shen Ting Ang</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://shenting.org/about/ title=About><span>About</span></a></li><li><a href=https://shenting.org/post/ title=Posts><span>Posts</span></a></li><li><a href=https://www.linkedin.com/in/angshenting/ title=LinkedIn><span>LinkedIn</span>&nbsp;
<svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">ETH Node Part 2: 64 Bit Ubuntu</h1><div class=post-meta><span title='2021-08-19 00:00:00 +0000 UTC'>August 19, 2021</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Shen Ting</div></header><div class=post-content><h1 id=out-of-memory>Out of memory<a hidden class=anchor aria-hidden=true href=#out-of-memory>#</a></h1><p>So I left the node running for a few days and noticed the sync rate dropping significantly. Upon watching the log print for a while, I saw the following:</p><blockquote><p>Aug 13 01:51:22 geth geth[12749]: runtime: out of memory: cannot allocate 4194304-byte block (2422145024 in use)</p><p>Aug 13 01:51:22 geth geth[12749]: fatal error: out of memory</p><p>Aug 13 01:51:22 geth geth[12749]: goroutine 16172 [running]:</p><p>Aug 13 01:51:22 geth geth[12749]: runtime.throw(0xce93c8, 0xd)</p><p>Aug 13 01:51:22 geth geth[12749]: #011runtime/panic.go:1117 +0x5c fp=0xc5b5334 sp=0xc5b5320 pc=0x5c328</p><p>Aug 13 01:51:22 geth geth[12749]: runtime.(*mcache).allocLarge(0xb6c53790, 0x8026, 0x20101, 0x29e20)</p><p>Aug 13 01:51:22 geth geth[12749]: #011runtime/mcache.go:226 +0x268 fp=0xc5b5364 sp=0xc5b5334 pc=0x3a888</p><p>Aug 13 01:51:22 geth geth[12749]: runtime.mallocgc(0x8026, 0xbaee50, 0x2001, 0x2bcf04)</p><p>Aug 13 01:51:22 geth geth[12749]: #011runtime/malloc.go:1078 +0x9c8 fp=0xc5b53c0 sp=0xc5b5364 pc=0x307d8</p><p>Aug 13 01:51:22 geth geth[12749]: runtime.makeslice(0xbaee50, 0x6922, 0x8026, 0x29ddc)</p><p>Aug 13 01:51:22 geth geth[12749]: #011runtime/slice.go:98 +0x6c fp=0xc5b53d4 sp=0xc5b53c0 pc=0x75a48</p></blockquote><p>Well, that’s not good. After this repeated a few times, I googled and realised that the default Raspbian OS wouldn’t work in terms of memory addressing. The solution would be to download the image off: <a href=https://ethereum.org/en/developers/tutorials/run-node-raspberry-pi/>https://ethereum.org/en/developers/tutorials/run-node-raspberry-pi/</a></p><h1 id=wrong-image>Wrong Image<a hidden class=anchor aria-hidden=true href=#wrong-image>#</a></h1><p>For some reason I downloaded the image for NanoPC instead of Raspberry Pi, which wrote the SD card as ext4 instead of FAT. The site took really long to download the image (averaging 200KB/s for a 700MB file took an hour zzz), but once that was done, it took 10 minutes for the initial set up.</p><p>Now to think of it, I downloaded the wrong image because the ethraspbian side wasn’t even allowing me to download the right image the other day, and going to ethraspbian.com directed me to the wrong image instead.</p><h1 id=ssh>SSH<a hidden class=anchor aria-hidden=true href=#ssh>#</a></h1><p>The first thing I noticed was slow response to the prompt after entering the password for SSH.</p><p>The top result on Google suggested DNS: <a href=https://jrs-s.net/2017/07/01/slow-ssh-logins/>https://jrs-s.net/2017/07/01/slow-ssh-logins/</a> but this wasn’t it. The helpful reminder was to use the -vv flag to debug, which led me to this: <a href=https://serverfault.com/questions/792486/ssh-connection-takes-forever-to-initiate-stuck-at-pledge-network>https://serverfault.com/questions/792486/ssh-connection-takes-forever-to-initiate-stuck-at-pledge-network</a>. Checking the ssh config file revealed that it was PAM which was causing the issue. A restart of SSH daemon and the issue disappeared.</p><h1 id=running-geth-as-a-service>Running geth as a service<a hidden class=anchor aria-hidden=true href=#running-geth-as-a-service>#</a></h1><p>[Note: because I used the ETH 2.0 image, and geth isn’t installed, I had to install golang and the latest version (1.10.7 as of writing) of geth manually, following the instructions from the previous guide.]</p><p>This failed repeatedly, despite the command running perfectly fine. Journalctl turns up nothing, but wait, a few other services are failing too, referencing to ‘/dev/sda1’. But we have no /dev/sda1, so I commented out the line in /etc/fstab, and rebooted with bated breath…no issues on reboot! And now systemctl starts geth immediately. Who would have thought it?</p><p>After a few hours of troubleshooting, I have a sync-ing node again, and now I can monitor system parameters via Grafana. Let’s see how this goes!</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://shenting.org/tags/ethereum/>Ethereum</a></li><li><a href=https://shenting.org/tags/web3/>Web3</a></li><li><a href=https://shenting.org/tags/node/>Node</a></li></ul></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://shenting.org/>Shen Ting Ang</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>